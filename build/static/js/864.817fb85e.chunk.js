(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[864,5831],{16027:(e,t,a)=>{"use strict";a.d(t,{Af:()=>T,C7:()=>G,CB:()=>O,Ec:()=>V,F3:()=>u,GV:()=>Y,HD:()=>F,HJ:()=>j,I9:()=>N,JQ:()=>p,K$:()=>v,Kl:()=>M,Kz:()=>D,LB:()=>C,Lx:()=>r,Nw:()=>S,P2:()=>L,QQ:()=>l,Rs:()=>x,Sv:()=>z,Um:()=>b,VR:()=>w,X9:()=>H,Y$:()=>R,Yv:()=>_,Yw:()=>g,_B:()=>K,ch:()=>$,fw:()=>k,gT:()=>X,h0:()=>U,hg:()=>f,jS:()=>W,jw:()=>I,k6:()=>A,o_:()=>m,pb:()=>E,r$:()=>P,rp:()=>Q,u9:()=>d,um:()=>B,v7:()=>h,w4:()=>q,wr:()=>y});var n=a(77154),c=a(1880);const s="http://66.179.250.128:5000",o=n.A.create({baseURL:s,headers:{"Content-Type":"application/json"}}),i=()=>{const e=c.A.get("accessToken");e&&(o.defaults.headers.common.Authorization="Bearer ".concat(e))};i(),o.interceptors.response.use((e=>e),(e=>(e.response&&401===e.response.status&&(window.location.href="/admin-login"),Promise.reject(e))));const r=async e=>{try{const t=await o.post("".concat(s,"/admin/login"),e);if(t.data.success){const e=t.data.data.token;c.A.set("accessToken",e,{secure:!0,sameSite:"strict"});const a=t.data.data.name;c.A.set("name",a,{secure:!0,sameSite:"strict"});const n=t.data.data.id;c.A.set("adminId",n,{secure:!0,sameSite:"strict"}),i()}return t.data}catch(t){throw console.log("error",t),t}},l=async()=>{try{return(await o.get("".concat(s,"/organization"))).data}catch(e){throw e}},d=async e=>{try{return(await o.get("".concat(s,"/organization/").concat(e))).data}catch(t){throw t}},u=async e=>{try{return(await o.post("".concat(s,"/organization"),e)).data}catch(t){throw t}},h=async e=>{try{return(await o.delete("".concat(s,"/organization/").concat(e))).data}catch(t){throw t}},m=async(e,t)=>{try{return(await o.patch("".concat(s,"/organization/").concat(e),t)).data}catch(a){throw a}},x=async()=>{try{return(await o.get("".concat(s,"/teacher"))).data}catch(e){throw e}},w=async e=>{try{return(await o.get("".concat(s,"/teacher/by-organization/").concat(e))).data}catch(t){throw t}},g=async e=>{try{return(await o.post("".concat(s,"/teacher"),e)).data}catch(t){throw t}},y=async e=>{try{return(await o.delete("".concat(s,"/teacher/").concat(e))).data}catch(t){throw t}},j=async(e,t)=>{try{return(await o.patch("".concat(s,"/teacher/").concat(e),t)).data}catch(a){throw a}},p=async()=>{try{return(await o.get("".concat(s,"/levels"))).data}catch(e){throw e}},v=async e=>{try{return(await o.post("".concat(s,"/levels"),e)).data}catch(t){throw t}},_=async e=>{try{return(await o.delete("".concat(s,"/levels/").concat(e))).data}catch(t){throw t}},f=async(e,t)=>{try{return(await o.patch("".concat(s,"/levels/").concat(e),t)).data}catch(a){throw a}},C=async e=>{try{return(await o.get("".concat(s,"/question/by_level/").concat(e))).data}catch(t){throw t}},T=async e=>{try{return(await o.post("".concat(s,"/question"),e)).data}catch(t){throw t}},b=async e=>{try{return(await o.delete("".concat(s,"/question/").concat(e))).data}catch(t){throw t}},S=async(e,t)=>{try{return(await o.patch("".concat(s,"/question/").concat(e),t)).data}catch(a){throw a}},N=async e=>{try{return(await o.get("".concat(s,"/student"))).data}catch(t){throw t}},A=async e=>{try{return(await o.get("".concat(s,"/student/organization/").concat(e))).data}catch(t){throw t}},I=async e=>{try{return(await o.post("".concat(s,"/student"),e)).data}catch(t){throw t}},P=async e=>{try{return(await o.delete("".concat(s,"/student/").concat(e))).data}catch(t){throw t}},R=async(e,t)=>{try{return(await o.patch("".concat(s,"/student/").concat(e),t)).data}catch(a){throw a}},O=async()=>{try{return(await o.get("".concat(s,"/exam"))).data}catch(e){throw e}},D=async e=>{try{return(await o.get("".concat(s,"/exam/").concat(e))).data}catch(t){throw t}},k=async e=>{try{return(await o.get("".concat(s,"/exam/get-exam-student-by-exam-id/").concat(e))).data}catch(t){throw t}},H=async e=>{try{return(await o.delete("".concat(s,"/exam/removed-student-from-exam/").concat(e))).data}catch(t){throw t}},B=async e=>{try{return(await o.delete("".concat(s,"/exam/removed-question-from-exam/").concat(e))).data}catch(t){throw t}},E=async e=>{try{return(await o.post("".concat(s,"/exam"),e)).data}catch(t){throw t}},F=async e=>{try{return(await o.delete("".concat(s,"/exam/").concat(e))).data}catch(t){throw t}},z=async(e,t)=>{try{return(await o.patch("".concat(s,"/exam/").concat(e),t)).data}catch(a){throw a}},G=async e=>{try{return(await o.get("".concat(s,"/exam/by-organization-id-for-admin/").concat(e))).data}catch(t){throw t}},q=async e=>{try{return(await o.get("".concat(s,"/exam/get-exam-qestion-by-exam-id/").concat(e))).data}catch(t){throw t}},U=async e=>{try{return(await o.post("".concat(s,"/exam/add-exam-student"),e)).data}catch(t){throw t}},Q=async e=>{try{return(await o.post("".concat(s,"/exam/organization-student-not-exit"),e)).data}catch(t){throw t}},M=async e=>{try{return(await o.post("".concat(s,"/exam/question-not-exit"),e)).data}catch(t){throw t}},Y=async e=>{try{return(await o.post("".concat(s,"/exam/add-exam-question"),e)).data}catch(t){throw t}},L=async e=>{try{return(await o.get("".concat(s,"/exam/schedule-exam/").concat(e))).data}catch(t){throw t}},W=async e=>{try{return(await o.get("".concat(s,"/exam-submission/by-examination-id/").concat(e))).data}catch(t){throw t}},V=async e=>{try{return(await o.post("".concat(s,"/exam/update-student-certificate"),e)).data}catch(t){throw t}},K=async e=>{try{return(await o.get("".concat(s,"/exam/update-student-certificate-generate/").concat(e))).data}catch(t){throw t}},X=async e=>{try{return(await o.get("".concat(s,"/exam/recent/dashboard"))).data}catch(t){throw t}},$=async e=>{try{return(await o.post("".concat(s,"/question/bulk"),e)).data}catch(t){throw t}}},77910:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>E});var n=a(65043),c=a(85369),s=a(84718),o=a(93946),i=a(73216),r=a(6145),l=a(53567),d=a(99870),u=a(9839),h=a(46130),m=a(12403),x=a(20698),w=a(39549),g=a(70579);const y=e=>{var t,a,n,c,s,i,y,j,p;console.log("prop",e);const v=e=>{const t=new Date(e).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"}),a=new Date(e).toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric",hour12:!0});return"".concat(t," ").concat(a)};return(0,g.jsx)(o.sK,{children:(0,g.jsxs)(o.x$,{className:"mb-4",children:[(0,g.jsx)(o.UF,{md:3,className:"mt-md-0 mt-2",children:(0,g.jsx)(o.U0,{icon:(0,g.jsx)(r.A,{icon:l.h,height:36}),value:null===(t=e.data[0])||void 0===t?void 0:t.exam_name,title:"Exam Name"})}),(0,g.jsx)(o.UF,{md:3,className:"mt-md-0 mt-2",children:(0,g.jsx)(o.U0,{icon:(0,g.jsx)(r.A,{icon:d.d,height:36}),value:null===(a=e.data[0])||void 0===a?void 0:a.organization_id.name,title:"Organization Details"})}),(0,g.jsx)(o.UF,{md:3,className:"mt-md-0 mt-2",children:(0,g.jsx)(o.U0,{icon:(0,g.jsx)(r.A,{icon:u.F,height:36}),value:null===(n=e.data[0])||void 0===n?void 0:n.level_id.name,title:"Level Details"})}),(0,g.jsx)(o.UF,{md:3,className:"mt-md-0 mt-2",children:(0,g.jsx)(o.U0,{icon:(0,g.jsx)(r.A,{icon:h.N,height:36}),value:null===(c=e.data[0])||void 0===c?void 0:c.teacher_id.name,title:"Incharge Teacher Name"})}),(0,g.jsx)(o.UF,{md:3,className:"mt-md-0 mt-2",children:(0,g.jsx)(o.U0,{icon:(0,g.jsx)(r.A,{icon:m.V,height:36}),value:v(null===(s=e.data[0])||void 0===s?void 0:s.examDateTime),title:"Start Date and Time"})}),(0,g.jsx)(o.UF,{md:3,className:"mt-md-0 mt-2",children:(0,g.jsx)(o.U0,{icon:(0,g.jsx)(r.A,{icon:m.V,height:36}),value:v(null===(i=e.data[0])||void 0===i?void 0:i.examEndDateTime),title:"Start Date and Time"})}),(0,g.jsx)(o.UF,{md:3,className:"mt-md-0 mt-2",children:(0,g.jsx)(o.U0,{icon:(0,g.jsx)(r.A,{icon:x.p,height:36}),value:null===(y=e.data[0])||void 0===y?void 0:y.exam_duration,title:"Exam Duration"})}),(0,g.jsx)(o.UF,{md:3,className:"mt-md-0 mt-2",children:(0,g.jsx)(o.U0,{icon:(0,g.jsx)(r.A,{icon:w.Q,height:36}),value:null===(j=e.data[0])||void 0===j?void 0:j.total_marks,title:"Total Marks, Total ".concat(null===(p=e.data[0])||void 0===p?void 0:p.total_marks," Question Allowed")})})]})})};var j=a(16027),p=a(30064),v=a.n(p),_=a(42145),f=(a(2574),a(69441)),C=a(68155),T=a(8588),b=(a(1880),a(48953));const S=a.p+"static/media/certificate.144804060bf47808628b.jpeg",N=b.vv.create({page:{backgroundColor:"#fff",flexDirection:"column",justifyContent:"flex-start",marginBottom:20},section:{marginBottom:5},image:{width:"100%",height:"410px",marginBottom:"5px"}});function A(e){let{data:t}=e;const a=[...new Set(t.map((e=>e.exam_certificate)))],n=[];for(let c=0;c<a.length;c+=2)n.push(a.slice(c,c+2));return(0,g.jsx)(b.yo,{children:n.map(((e,t)=>(0,g.jsx)(b.YW,{size:"A4",style:N.page,children:e.map(((e,t)=>(0,g.jsx)(b.Ss,{style:N.section,children:(0,g.jsx)(b._V,{src:e,style:N.image})},t)))},t)))})}const I=function(e){var t;let{examId:a,data:n}=e,s=n.filter((e=>!1!==e.is_completed));return(0,g.jsx)("div",{children:(0,g.jsx)(b.XP,{document:(0,g.jsx)(A,{data:s}),fileName:"".concat(null===(t=n[0])||void 0===t?void 0:t.exam_id.exam_name,".pdf"),children:e=>{let{blob:t,url:a,loading:n,error:s}=e;return n?"Loading Certificate...":(0,g.jsx)(g.Fragment,{children:(0,g.jsxs)("button",{type:"button",className:"btn btn-danger text-white",style:{cursor:"pointer"},children:[(0,g.jsx)(c.WCW,{})," Download All Certificate"]})})}})})};a(65239);var P=a(41434);const R=function(e){let{updateData:t,examData:a,isExamDone:c,data:s}=e;const{id:o}=(0,i.g)(),[r,l]=(0,n.useState)(!1),[d,u]=(0,n.useState)(!1),[h,m]=(0,n.useState)(!1),[x,w]=(0,n.useState)([]),[y,p]=(0,n.useState)([]);(0,i.Zp)(),(0,n.useEffect)((()=>{var e,t;null!==(e=a[0])&&void 0!==e&&e.organization_id._id&&b(null===(t=a[0])||void 0===t?void 0:t.organization_id._id)}),[a]),(0,n.useEffect)((()=>{h?v().fire({title:"Please Wait",text:"We are generating your all certificate, It might take some time. Please wait.",showConfirmButton:!1,allowOutsideClick:!1,icon:"info"}):v().close()}),[h]);const b=async e=>{let t={exam_id:o,org_id:e};const a=await(0,j.rp)(t);a.success&&(p(a.data),u(!0))},N=()=>{l(!r)},A=y.map((e=>({value:e._id,label:"".concat(e.name," - ").concat(e.level_id.name)}))),R=e=>new Promise(((t,a)=>{const n=new FormData;n.append("file",e),n.append("upload_preset","school_management"),fetch("https://api.cloudinary.com/v1_1/dqdnj2szc/image/upload",{method:"POST",body:n}).then((e=>e.json())).then((e=>t(e))).catch((e=>a(e)))})),O=e=>new Promise(((t,a)=>{(0,j.Ec)(e).then((()=>t())).catch((e=>a(e)))}));return(0,g.jsxs)("div",{className:"container bg-white mt-3",children:[(0,g.jsxs)("div",{className:"row",children:[(0,g.jsx)("div",{className:"col-6 my-3",children:(0,g.jsx)("h3",{children:"Exam Student Info"})}),c?(0,g.jsx)(g.Fragment,{children:(0,g.jsx)("div",{className:"col-6 my-3 text-end",children:a[0].is_generated?(0,g.jsxs)(g.Fragment,{children:[" ",(0,g.jsx)(I,{examId:o,data:s})]}):(0,g.jsx)(g.Fragment,{children:(0,g.jsxs)("button",{type:"button text-white",className:"btn btn-danger",style:{color:"white"},onClick:()=>new Promise((async(e,t)=>{if((await v().fire({title:"Are you sure to generate all certificate?",text:"You will not be able to recover this!",icon:"success",showCancelButton:!0,confirmButtonColor:"#28a745",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, Generate it!"})).isConfirmed)try{m(!0);let t=s.filter((e=>!1!==e.is_completed));console.log("arrayOfObjects",t);let a=0,n=t.length;if(await Promise.all(t.map((async e=>{await(e=>new Promise(((t,a)=>{const n=new Image;n.src=S,n.onload=async()=>{const c=document.createElement("canvas"),s=c.getContext("2d");c.width=n.naturalWidth,c.height=n.naturalHeight,s.drawImage(n,0,0);const o=new Date(e.exam_id.examDateTime).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"});s.font="30px Arial",s.fillStyle="black",s.fillText("".concat(e.student_id.name),528,650),s.fillText("".concat(e.exam_id.level_id.name),810,800),s.fillText("".concat(e.exam_id.organization_id.address),940,910),s.fillText("".concat(o),677,910);const i=c.toDataURL("image/png");try{const a=await R(i),n={examination_id:e._id,image:a.secure_url};await O(n),t()}catch(r){a(r)}}})))(e),a++}))),a===n){(await(0,j._B)(o)).success?(m(!1),_.oR.success("Certificate generated successfully",{position:_.oR.POSITION.TOP_RIGHT,autoClose:3e3}),setTimeout((()=>{window.location.reload()}),2e3)):(_.oR.error("Something went wrong...!",{position:_.oR.POSITION.TOP_RIGHT,autoClose:3e3}),v().close()),e()}}catch(a){t(a)}})),children:[(0,g.jsx)(P.VWS,{}),"  Generate Certificate"]})})})}):(0,g.jsx)(g.Fragment,{children:(0,g.jsx)("div",{className:"col-6 my-3 text-end",children:(0,g.jsx)("button",{type:"button",className:"btn btn-primary",onClick:N,children:"Add Student"})})}),(0,g.jsx)("hr",{})]}),(0,g.jsxs)(f.A,{show:r,onHide:N,backdrop:"static",children:[(0,g.jsx)(f.A.Header,{closeButton:!0,children:(0,g.jsx)(f.A.Title,{children:"Add Student"})}),(0,g.jsx)(f.A.Body,{children:(0,g.jsx)(T.Ay,{options:A,isMulti:!0,closeMenuOnSelect:!1,onChange:e=>{w(e.map((e=>e.value)))},value:A.filter((e=>x.includes(e.value)))})}),(0,g.jsxs)(f.A.Footer,{children:[(0,g.jsx)(C.A,{variant:"primary",onClick:async e=>{try{if(e.preventDefault(),0==x.length)return void _.oR.error("Please select atleast one student",{position:_.oR.POSITION.TOP_RIGHT,autoClose:3e3});x.map((async e=>{const t={exam_id:o,student_id:e};await(0,j.h0)(t)})),_.oR.success("Student added successfully",{position:_.oR.POSITION.TOP_RIGHT,autoClose:3e3}),N(),setTimeout((()=>{t(),b()}),2e3)}catch(a){_.oR.error("Something went wrong...!",{position:_.oR.POSITION.TOP_RIGHT,autoClose:3e3})}},children:"Save"}),(0,g.jsx)(C.A,{variant:"secondary",onClick:N,children:"Cancel"})]})]})]})};const O=function(e){let{renderQuestionData:t,examData:a,isExamDone:c}=e;const{id:s}=(0,i.g)(),[o,r]=(0,n.useState)(!1),[l,d]=(0,n.useState)([]),[u,h]=(0,n.useState)([]);(0,n.useEffect)((()=>{var e,t;null!==(e=a[0])&&void 0!==e&&e.organization_id._id&&m(null===(t=a[0])||void 0===t?void 0:t.level_id._id)}),[a]);const m=async e=>{let t={exam_id:s,level_id:e};const a=await(0,j.Kl)(t);h(a.data)},x=()=>{r(!o)},w=u.map((e=>({value:e._id,label:e.question})));return(0,g.jsxs)("div",{className:"container bg-white mt-5",children:[(0,g.jsxs)("div",{className:"row",children:[(0,g.jsx)("div",{className:"col-6 my-3",children:(0,g.jsx)("h3",{children:"Exam Question Info"})}),c?"":(0,g.jsx)(g.Fragment,{children:(0,g.jsx)("div",{className:"col-6 my-3 text-end",children:(0,g.jsx)("button",{type:"button",className:"btn btn-primary",onClick:x,children:"Add Question"})})}),(0,g.jsx)("hr",{})]}),(0,g.jsxs)(f.A,{show:o,onHide:x,backdrop:"static",children:[(0,g.jsx)(f.A.Header,{closeButton:!0,children:(0,g.jsx)(f.A.Title,{children:"Add Question"})}),(0,g.jsx)(f.A.Body,{children:(0,g.jsx)(T.Ay,{options:w,isMulti:!0,closeMenuOnSelect:!1,onChange:e=>{d(e.map((e=>e.value)))},value:w.filter((e=>l.includes(e.value)))})}),(0,g.jsxs)(f.A.Footer,{children:[(0,g.jsx)(C.A,{variant:"primary",onClick:async e=>{try{if(e.preventDefault(),console.log("Selected students:",l),0===l.length)return void _.oR.error("Please select at least one question",{position:_.oR.POSITION.TOP_RIGHT,autoClose:3e3});let n=!0;for(let e=0;e<l.length;e++){const c=l[e],o={exam_id:s,question_id:c};try{const e=await(0,j.GV)(o);e.success||(n=!1,_.oR.error("".concat(e.message),{position:_.oR.POSITION.TOP_RIGHT,autoClose:1e4}),x(),setTimeout((()=>{t(),m()}),2e3))}catch(a){console.error("Error adding question:",a.message),_.oR.error("".concat(a.message),{position:_.oR.POSITION.TOP_RIGHT,autoClose:3e3})}}n&&(_.oR.success("Questions added successfully",{position:_.oR.POSITION.TOP_RIGHT,autoClose:3e3}),x(),setTimeout((()=>{t(),m()}),2e3))}catch(n){console.error("Error:",n),_.oR.error("Something went wrong...!",{position:_.oR.POSITION.TOP_RIGHT,autoClose:3e3})}},children:"Save"}),(0,g.jsx)(C.A,{variant:"secondary",onClick:x,children:"Cancel"})]})]})]})};var D=a(64196);const k=function(e){var t,a,s;let{showModal:o,closeModal:i,studentExamId:r}=e;const[l,d]=(0,n.useState)([]),[u,h]=(0,n.useState)("");(0,n.useEffect)((()=>{m()}),[]);const m=async()=>{const e=await(0,j.jS)(r);e.success&&d(e.data)};return console.log("data",l),(0,g.jsxs)(f.A,{show:o,onHide:i,size:"lg",children:[(0,g.jsx)(f.A.Header,{closeButton:!0,children:(0,g.jsx)(f.A.Title,{children:"Answer Paper"})}),(0,g.jsx)(f.A.Body,{children:(0,g.jsxs)("div",{className:"row",children:[(0,g.jsx)("div",{className:"col-12",children:l.map(((e,t)=>(0,g.jsxs)("div",{children:[(0,g.jsxs)("p",{children:[t+1,". ",e.question_id.question]}),(0,g.jsx)("div",{className:"row",children:e.options.map(((e,t)=>{let a="";return e.is_answer&&e.is_true?a="right_answer":e.is_answer&&(a="wrong_answer"),(0,g.jsx)("div",{className:"col-6 px-4",children:(0,g.jsxs)("p",{className:a,children:[(0,g.jsxs)("span",{children:[t+1,")"]})," ",e.name]})},t)}))}),e.options.map(((t,a)=>{if(t.is_true)return(0,g.jsx)("div",{className:"col-12 text-end",children:(0,g.jsxs)("p",{children:[(0,g.jsx)("b",{children:"Answer- "}),(0,g.jsx)("span",{children:t.name}),"  (",(0,g.jsxs)("span",{className:"colorRed",children:[" ",null!==e&&void 0!==e&&e.is_question_answer_right?(0,g.jsx)(c.CMH,{color:"green"}):(0,g.jsx)(g.Fragment,{children:"X"})," "]}),")"]})})})),(0,g.jsx)("hr",{})]},t)))}),(0,g.jsxs)("div",{className:"col-12",children:[(0,g.jsx)("h2",{children:"Results"}),(0,g.jsxs)(D.A,{striped:!0,bordered:!0,hover:!0,children:[(0,g.jsx)("thead",{children:(0,g.jsxs)("tr",{children:[(0,g.jsx)("th",{children:"Total Question"}),(0,g.jsx)("th",{children:"Right Answer"}),(0,g.jsx)("th",{children:"Wrong Answer"}),(0,g.jsx)("th",{children:"Total Score"})]})}),(0,g.jsx)("tbody",{children:(0,g.jsxs)("tr",{children:[(0,g.jsx)("td",{children:l.length}),(0,g.jsx)("td",{children:null===(t=l[0])||void 0===t?void 0:t.examination_id.correct_questions}),(0,g.jsx)("td",{children:null===(a=l[0])||void 0===a?void 0:a.examination_id.wrong_questions}),(0,g.jsx)("td",{children:null===(s=l[0])||void 0===s?void 0:s.examination_id.exam_score})]})})]})]})]})}),(0,g.jsx)(f.A.Footer,{children:(0,g.jsx)(C.A,{variant:"secondary",onClick:i,children:"Close"})})]})};var H=a(37762);const B=e=>{let{data:t,setIsCertificateModalOpen:a}=e;const[s,o]=(0,n.useState)(!1),i=(0,n.useRef)(null),r=(0,n.useRef)(null);(0,n.useEffect)((()=>{if(!s)return;const e=new Date(t.exam_id.examDateTime).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"}),a=r.current.getContext("2d");a.clearRect(0,0,r.current.width,r.current.height),a.drawImage(i.current,0,0,r.current.width,r.current.height),a.font="30px Arial",a.fillStyle="black",a.fillText("".concat(t.student_id.name),528,650),a.fillText("".concat(t.exam_id.level_id.name),810,800),a.fillText("".concat(t.exam_id.organization_id.address),940,910),a.fillText("".concat(e),677,910)}),[t.student_id.name,s]);return(0,g.jsx)("div",{children:(0,g.jsxs)(f.A,{show:!0,onHide:()=>a(!1),dialogClassName:"modal-125w",contentClassName:"modal-content-100w",size:"xl","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[(0,g.jsx)(f.A.Header,{closeButton:!0,children:(0,g.jsx)(f.A.Title,{children:"Certificate"})}),(0,g.jsxs)(f.A.Body,{children:[(0,g.jsx)("canvas",{ref:r,width:"100%",height:"auto",style:{width:"-webkit-fill-available"}}),(0,g.jsx)("img",{ref:i,src:S,alt:"Certificate",style:{display:"none"},onLoad:()=>{o(!0),r.current.width=i.current.naturalWidth,r.current.height=i.current.naturalHeight}})]}),(0,g.jsxs)(f.A.Footer,{children:[(0,g.jsxs)(C.A,{variant:"success",style:{color:"white"},onClick:()=>{const e=document.createElement("a");e.download="certificate_".concat(t.student_id.name,".png"),e.href=r.current.toDataURL("image/png"),e.click()},children:[(0,g.jsx)(c.WCW,{})," Download Certificate"]}),(0,g.jsxs)(C.A,{variant:"primary",onClick:()=>{const e=r.current.toDataURL("image/png"),a=new H.Ay("p","mm","a4"),n=new Image;n.src=e,n.onload=function(){const c=210/(n.width/n.height)-10;a.addImage(e,"PNG",5,5,200,c),a.autoPrint(),a.save("certificate_".concat(t.student_id.name,".pdf"))}},children:[(0,g.jsx)(c.n4o,{})," Print Certificate"]}),(0,g.jsx)(C.A,{variant:"secondary",onClick:()=>a(!1),children:"Close"})]})]})})};const E=function(){const{id:e}=(0,i.g)(),[t,a]=(0,n.useState)([]),[r,l]=(0,n.useState)([]),[d,u]=(0,n.useState)([]),[h,m]=(0,n.useState)(!1),[x,w]=(0,n.useState)(!1),[p,f]=(0,n.useState)(!1),[C,T]=(0,n.useState)(!1),[b,S]=(0,n.useState)(null),[N,A]=(0,n.useState)({}),[I,P]=(0,n.useState)(!1),[D,H]=(0,n.useState)(""),[E,F]=(0,n.useState)(!1);(0,n.useEffect)((()=>{G(),z(),q()}),[]);const z=async()=>{const t=await(0,j.fw)(e);t.success&&a(t.data)},G=async()=>{const t=await(0,j.Kz)(e);if(t.success){l(t.data),w(t.data[0].is_schedule);const e=new Date(t.data[0].examDateTime),a=new Date(t.data[0].examEndDateTime),n=new Date;n<e?m(!1):n>=e&&n<=a||m(!0)}},q=async()=>{const t=await(0,j.w4)(e);t.success&&u(t.data)},U=[{Header:"Student Name",accessor:"student_id.name"},{Header:"Mobile Number",accessor:"student_id.mobile_number"},{Header:"Role Number",accessor:"student_id.roll_no"},{Header:"Level Name",accessor:"exam_id.level_id.name"},{Header:"Organization Name",accessor:"exam_id.organization_id.name"},{Header:"Created Type",accessor:"student_id.created_type"},{Header:"Exam Marks",accessor:"exam_score",Cell:e=>{let{value:t}=e;return t}},{Header:"Exam Status",accessor:"is_completed",Cell:e=>{let{value:t}=e;return t?"Completed":"Not Attempted"}},{Header:"Actions",accessor:"_id",Cell:e=>{let{row:t}=e;return(0,g.jsx)(g.Fragment,{children:h?(0,g.jsx)(g.Fragment,{children:t.original.is_completed?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)(o.Q_,{color:"success",size:"sm",style:{color:"white"},onClick:()=>{return e=t.original,A(e),void F(!0);var e},children:[(0,g.jsx)(c.Ny1,{})," View Certificate"]}),(0,g.jsxs)(o.Q_,{color:"primary",size:"sm",style:{color:"white",margin:"0 10px"},onClick:()=>(e=>{S(e),T(!0)})(t.original._id),children:[(0,g.jsx)(c.Ny1,{})," View Answer Paper"]})]}):"-"}):(0,g.jsx)(g.Fragment,{children:(0,g.jsxs)(o.Q_,{color:"danger",size:"sm",style:{color:"white"},onClick:()=>(async e=>{if((await v().fire({title:"Are you sure?",text:"You will not be able to recover this student!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!"})).isConfirmed)try{const t=await(0,j.X9)(e);t.success&&(_.oR.success(t.message,{position:_.oR.POSITION.TOP_RIGHT,autoClose:3e3}),z())}catch(t){_.oR.error(t.message,{position:_.oR.POSITION.TOP_RIGHT,autoClose:3e3})}})(t.original._id),children:[(0,g.jsx)(c.qbC,{})," Delete"]})})})}}],Q=[{Header:"Exam Name",accessor:"exam_id.exam_name"},{Header:"Question Name",accessor:"question_id.question"},{Header:"Question Type",accessor:"question_id.is_type"},{Header:"Actions",accessor:"_id",Cell:e=>{let{row:t}=e;return(0,g.jsx)(g.Fragment,{children:h?"-":(0,g.jsx)(g.Fragment,{children:(0,g.jsxs)(o.Q_,{color:"danger",size:"sm",style:{color:"white"},onClick:()=>(async e=>{if((await v().fire({title:"Are you sure?",text:"You will not be able to recover this student!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!"})).isConfirmed)try{const t=await(0,j.um)(e);t.success&&(_.oR.success(t.message,{position:_.oR.POSITION.TOP_RIGHT,autoClose:3e3}),q())}catch(t){_.oR.error(t.message,{position:_.oR.POSITION.TOP_RIGHT,autoClose:3e3})}})(t.original._id),children:[(0,g.jsx)(c.qbC,{})," Delete"]})})})}}];return(0,g.jsxs)("div",{children:[x?"":(0,g.jsxs)("div",{className:"row my-3",children:[(0,g.jsx)("div",{className:"col-6",children:(0,g.jsx)("h5",{children:"Examination Info"})}),(0,g.jsx)("div",{className:"col-6 text-end",children:(0,g.jsx)("button",{className:"btn btn-primary",onClick:async()=>{if((await v().fire({title:"Are you sure?",text:"You will not be able to recover this!",icon:"success",showCancelButton:!0,confirmButtonColor:"#28a745",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, Schedule it!"})).isConfirmed)try{const t=await(0,j.P2)(e);t.success&&(_.oR.success(t.message,{position:_.oR.POSITION.TOP_RIGHT,autoClose:3e3}),q(),w(!0))}catch(t){_.oR.error(t.message,{position:_.oR.POSITION.TOP_RIGHT,autoClose:3e3})}},children:" Schedule Exam  "})})]}),h?(0,g.jsx)(g.Fragment,{children:(0,g.jsx)("div",{className:"row my-3",children:(0,g.jsx)("div",{className:"col-12 text-center",children:(0,g.jsx)("h5",{className:"text-danger",children:"Examination Time End, Now You Can't Delete User And Question Info. Now You Able Download Certificate. Thank You. "})})})}):"",(0,g.jsx)(y,{data:r}),(0,g.jsx)(R,{updateData:async()=>{await z()},examData:r,data:t,isExamDone:h}),(0,g.jsx)(s.A,{columns:U,data:t}),(0,g.jsx)(O,{renderQuestionData:async()=>{await q()},examData:r,isExamDone:h}),(0,g.jsx)(s.A,{columns:Q,data:d,name:"Exam Question Info"}),C?(0,g.jsx)(k,{showModal:C,closeModal:()=>{T(!1)},studentExamId:b}):"",E?(0,g.jsx)(B,{data:N,setIsCertificateModalOpen:F}):""]})}},84718:(e,t,a)=>{"use strict";a.d(t,{A:()=>d});var n=a(65043),c=a(71094),s=a(61270),o=a(68155),i=a(64196),r=a(11238),l=a(70579);const d=e=>{let{columns:t,data:a,name:d}=e;const{getTableProps:u,getTableBodyProps:h,headerGroups:m,prepareRow:x,page:w,state:{pageIndex:g,pageSize:y,globalFilter:j},setGlobalFilter:p,gotoPage:v,nextPage:_,previousPage:f,canNextPage:C,canPreviousPage:T}=(0,c.useTable)({columns:t,data:a,initialState:{pageIndex:0,pageSize:10}},c.useGlobalFilter,c.useSortBy,c.usePagination);return(0,l.jsxs)("div",{className:"data-table-container",children:[(0,l.jsx)("h5",{children:d||""}),(0,l.jsxs)("div",{className:"data-table-header",children:[(0,l.jsxs)("div",{className:"search-box-container",children:[(0,l.jsx)(s.A,{type:"text",value:j||"",onChange:e=>p(e.target.value),placeholder:"Search..."}),(0,l.jsx)("span",{className:"search-icon",children:"\ud83d\udd0d"})]}),(0,l.jsx)(o.A,{onClick:()=>(()=>{const e=a.map((e=>t.reduce(((t,a)=>(t[a.Header]=e[a.accessor],t)),{}))),n=r.Wp.json_to_sheet(e),c=r.Wp.book_new();r.Wp.book_append_sheet(c,n,"Sheet 1"),r._h(c,"data.xlsx")})(),variant:"success",className:"download_excel",style:{color:"white"},children:"Download Excel"})]}),(0,l.jsx)("div",{className:"table-wrapper",children:(0,l.jsxs)(i.A,{...u(),bordered:!0,hover:!0,responsive:!0,children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{children:"Sr. No."}),m.map((e=>(0,l.jsx)(n.Fragment,{children:e.headers.map((e=>(0,l.jsxs)("th",{...e.getHeaderProps(e.getSortByToggleProps()),children:[e.render("Header"),(0,l.jsx)("span",{children:e.isSorted?e.isSortedDesc?" \ud83d\udd3d":" \ud83d\udd3c":""})]},e._id)))},e._id)))]})}),(0,l.jsx)("tbody",{...h(),children:w.map(((e,t)=>(x(e),(0,l.jsxs)("tr",{...e.getRowProps(),children:[(0,l.jsx)("td",{children:g*y+t+1}),e.cells.map((e=>(0,l.jsx)("td",{...e.getCellProps(),children:e.render("Cell")},e.column._id)))]},e._id))))})]})}),(0,l.jsxs)("div",{className:"pagination-controls",children:[(0,l.jsx)("button",{onClick:()=>v(0),disabled:!T,children:"<<"}),(0,l.jsx)("button",{onClick:()=>f(),disabled:!T,children:"<"}),(0,l.jsx)("button",{onClick:()=>_(),disabled:!C,children:">"}),(0,l.jsx)("button",{onClick:()=>v(w.length-1),disabled:!C,children:">>"}),(0,l.jsxs)("span",{children:["\xa0Page ",(0,l.jsx)("strong",{children:g+1})," of ",Math.ceil(a.length/y)," pages | Showing ",a.length," Records"]})]})]})}},50477:()=>{}}]);
//# sourceMappingURL=864.817fb85e.chunk.js.map